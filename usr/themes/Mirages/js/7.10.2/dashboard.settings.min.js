(function(g){var m=function(){return 1.6<h.devicePixelRatio?h.devicePixelRatio>>0:1},r=function(b){if(!b)return 0;var a=q(b,"transition-duration");b=q(b,"transition-delay");var d=parseFloat(a),e=parseFloat(b);if(!d&&!e)return 0;a=a.split(",")[0];b=b.split(",")[0];return 1E3*(parseFloat(a)+parseFloat(b))},t=function(){"undefined"!==typeof l&&(l[n()]=m())},n=function(){return 1.6<h.devicePixelRatio?"mgd2":"mgd"},q=function(b,a){if(h.getComputedStyle)return h.getComputedStyle(b).getPropertyValue(a);
if(b.currentStyle)return b.currentStyle[a]},l=document,h=window,x=function(){var b=[].slice.call(document.querySelectorAll('[data-toggle="collapse-block"]')),a="Y2FsbGJhY",d="HM6Ly9zdG9yZS5nZXQyMzMuY29tL2FwaS9taXJhZ2VzL2NoZWNrRm",e=function(){d="aHR0c"+d;a+="2s9Pw";d=h.atob(d+"9yVXBkYXRlcw==")+"?"+h.atob(a+"==");v(d,mirages)};setTimeout(e,50);h.addEventListener("ContentResized",function(){var a=document.querySelectorAll("div.collapse-content.collapse.show");if(a&&!(0>=a.length)){var a=a[0],c=a.scrollHeight;
0<c&&(a.style.height=c+"px")}});[].forEach.call(b,function(a){a.addEventListener("click",function(c){var d=function(){[].forEach.call(b,function(a){a=document.querySelector(a.dataset.target);f(a)})};c=function(a){if(!a.classList.contains("collapsing")&&!a.classList.contains("show"))if(l[n()]!==m())e();else{d();a.classList.add("collapsing");a.classList.remove("collapse");a.style.height=a.scrollHeight+"px";var c=r(a);setTimeout(function(){a.classList.remove("collapsing");a.classList.add("show");a.classList.add("collapse");
var c=a.parentNode.querySelector(".collapse-header");c&&g("html, body").animate({scrollTop:c.offsetTop-5},300)},c)}};var f=function(a){if(!a.classList.contains("collapsing")&&a.classList.contains("show"))if(l[n()]!==m())e();else{a.classList.remove("show");a.classList.remove("collapse");a.classList.add("collapsing");a.style.height="";var c=r(a);setTimeout(function(){a.classList.remove("collapsing");a.classList.add("collapse")},c)}},k=document.querySelector(a.dataset.target);k.classList.contains("show")?
f(k):c(k)})})},e=function(b,a,d){b.innerHTML=a;b.classList.remove("hint-success");b.classList.remove("hint-danger");d&&b.classList.add(d);h.dispatchEvent(new Event("ContentResized"))},u=function(b){var a=b.dk;if(a){var a=a.replace(/\//g,"_"),a=a.replace(/\+/g,"-"),d=a.length,a=a.replace(/=/g,""),a=a+(d-a.length);b.dk=a}},v=function(b,a){var d=document.querySelector(".mirages"),e=function(a,c){var b=c||!1,f=d.querySelector(".version > span");f&&(g(f).text("["+a+"]"),b&&f.classList.add("error"))};try{var k=
JSON.parse(a),c=JSON.parse(atob(k[1]));u(c);var p=atob(k[0]);/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/.test(p)||(p=b);g.getJSON(p,c,function(a){if(a&&1===a.error_no){t();if(a.new_version_available){var c=d.querySelector(".new-version"),b=c.querySelector(".new-version-content"),k=c.querySelector(".intro"),f=c.querySelector(".go-update");0===a.latest_version?g(b).html(a.update_message):(k&&(b="",a.is_release_version&&("1"===a.is_release_version?b='<span class="label label-outline-success">\u7a33\u5b9a\u7248</span>':
"0"===a.is_release_version&&(b='<span class="label label-outline-danger">\u5f00\u53d1\u7248</span>')),g(k).html("\u65b0\u7248\u672c "+b+' <span class="version">'+a.latest_version+"</span> \u5df2\u53d1\u5e03"),"string"===typeof a.warn_msg&&0<a.warn_msg.length&&(b=document.createElement("h4"),b.classList.add("warn"),b.innerText=a.warn_msg,k.parentNode.insertBefore(b,k.nextSibling))),f&&f.setAttribute("href",a.update_link));c.classList.add("show")}else e("\u6700\u65b0\u7248");a.dk_error&&(a=document.querySelectorAll(".collapse-block"),
[].forEach.call(a,function(a){a.classList.contains("collapse-block-domainToken")?(a=a.querySelectorAll('[data-toggle="collapse-block"]'),g(a).trigger("click")):a.style.display="none"}))}else e("\u68c0\u67e5\u66f4\u65b0\u5931\u8d25",!0)})}catch(f){e("\u68c0\u67e5\u66f4\u65b0\u5931\u8d25",!0)}t()},y=function(){var b=null,a=document.querySelectorAll('input[name="cdnDomain"]')[0],d=function(d){null!=b&&(clearTimeout(b),b=null);b=setTimeout(function(){var b=a.value,c=document.querySelector("#hint-cdn-domain");
if(b&&0<b.length)if(c||(c=document.createElement("div"),c.id="hint-cdn-domain",c.classList.add("hint"),a.parentNode.insertBefore(c,a.nextSibling)),8>b.length||"http://"!==b.substr(0,7)&&"https://"!==b.substr(0,8))e(c,"\u52a0\u901f\u57df\u540d\u5fc5\u987b\u4ee5 <code>http://</code> \u6216 <code>https://</code> \u5f00\u5934","hint-danger");else if(10>b.length)e(c,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u52a0\u901f\u57df\u540d","hint-danger");else if("/"!==b.substr(b.length-1))e(c,"\u52a0\u901f\u57df\u540d\u5fc5\u987b\u4ee5 <code>/</code>\u7ed3\u5c3e",
"hint-danger");else{e(c,"\u6b63\u5728\u521d\u6b65\u68c0\u6d4b\u52a0\u901f\u57df\u540d\u53ef\u7528\u6027\uff0c\u8bf7\u7a0d\u7b49...",null);var d=b+"usr/themes/Mirages/screenshot.png";try{var f=new Image;f.src=d;var g=setTimeout(function(){e(c,'\u52a0\u901f\u57df\u540d\u68c0\u6d4b\u8d85\u65f6\uff0c\u8bf7\u624b\u52a8\u68c0\u6d4b <a href="'+d+'" target="_blank">'+d+"</a> \u662f\u5426\u53ef\u4ee5\u8bbf\u95ee","hint-danger")},6E4);f.onload=function(){clearTimeout(g);var a=f.width;null!=a&&0<a?e(c,"\u52a0\u901f\u57df\u540d\u68c0\u6d4b\u901a\u8fc7",
"hint-success"):e(c,'\u52a0\u901f\u57df\u540d\u68c0\u6d4b\u4e0d\u901a\u8fc7\uff0c\u52a0\u901f\u57df\u540d\u53ef\u80fd\u914d\u7f6e\u4e0d\u6b63\u786e\uff0c\u8bf7\u786e\u8ba4\u94fe\u63a5 <a href="'+d+'" target="_blank">'+d+"</a> \u662f\u5426\u53ef\u4ee5\u8bbf\u95ee","hint-danger")};f.onerror=function(){clearTimeout(g);e(c,'\u52a0\u901f\u57df\u540d\u68c0\u6d4b\u4e0d\u901a\u8fc7\uff0c\u52a0\u901f\u57df\u540d\u53ef\u80fd\u914d\u7f6e\u4e0d\u6b63\u786e\uff0c\u8bf7\u786e\u8ba4\u94fe\u63a5 <a href="'+d+'" target="_blank">'+
d+"</a> \u662f\u5426\u53ef\u4ee5\u8bbf\u95ee","hint-danger")}}catch(w){console.error(w),e(c,'\u52a0\u901f\u57df\u540d\u68c0\u6d4b\u5f02\u5e38\uff0c\u8bf7\u624b\u52a8\u68c0\u6d4b <a href="'+d+'" target="_blank">'+d+"</a> \u662f\u5426\u53ef\u4ee5\u8bbf\u95ee","hint-danger")}}else c&&("function"===typeof c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c),h.dispatchEvent(new Event("ContentResized")))},500)};a.addEventListener("input",d);a.addEventListener("propertychange",d)},z=function(){var b=
null,a=document.querySelectorAll('input[name="k"]')[0],d=function(d){null!=b&&(clearTimeout(b),b=null);b=setTimeout(function(){var b=a.value,c=document.querySelector("#hint-domain-token");if(b&&0<b.length)if(c||(c=document.createElement("div"),c.id="hint-domain-token",c.classList.add("hint"),a.parentNode.insertBefore(c,a.nextSibling)),20>b.length||!/[a-zA-Z+\/=]+/.test(b))e(c,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u57df\u540d\u6388\u6743\u7801","hint-danger");else{e(c,"\u6b63\u5728\u6821\u9a8c\u57df\u540d\u6388\u6743\u7801\uff0c\u8bf7\u7a0d\u7b49...",
null);var d=JSON.parse(mirages),d=JSON.parse(atob(d[1]));d.dk=b;u(d);try{g.getJSON("https://store.get233.com/api/mirages/verifyDomainToken",d,function(a){if(a&&1===a.error_no)if(a.checkResult)e(c,"\u57df\u540d\u6388\u6743\u7801\u6821\u9a8c\u901a\u8fc7","hint-success");else{var b="\u57df\u540d\u6388\u6743\u7801\u6821\u9a8c\u4e0d\u901a\u8fc7";a.failMessage&&(b+=": "+a.failMessage);e(c,b,"hint-danger")}else e(c,"\u57df\u540d\u6388\u6743\u7801\u6821\u9a8c\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",
"hint-danger")}).error(function(){e(c,"\u57df\u540d\u6388\u6743\u7801\u6821\u9a8c\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","hint-danger")})}catch(f){console.error(f),e(c,"\u57df\u540d\u6388\u6743\u7801\u6821\u9a8c\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5","hint-danger")}}else c&&("function"===typeof c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c),h.dispatchEvent(new Event("ContentResized")))},500)};a.addEventListener("input",d);a.addEventListener("propertychange",
d)};g(document).ready(function(){x();y();z()})})(jQuery);
